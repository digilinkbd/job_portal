<!-- templates/accounts/job_seeker_profile.html -->
{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block title %}Job Seeker Profile - JobPortal{% endblock %}

{% block content %}
<div class="container" style="margin-top: 100px;">
    <div class="row justify-content-center">
        <div class="col-lg-10">
            <!-- Header -->
            <div class="row mb-4" data-aos="fade-down">
                <div class="col-12">
                    <div class="d-flex justify-content-between align-items-center">
                        <div>
                            <h1 class="display-6 text-gradient mb-2">Job Seeker Profile</h1>
                            <p class="lead text-muted">Complete your profile to attract employers</p>
                        </div>
                        <div>
                            <a href="{% url 'accounts:job_seeker_dashboard' %}" class="btn btn-outline-primary">
                                <i class="fas fa-arrow-left me-2"></i>Back to Dashboard
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Form -->
            <div class="row" data-aos="fade-up">
                <div class="col-12">
                    <div class="card shadow-custom">
                        <div class="card-header bg-gradient-primary text-white">
                            <div class="d-flex align-items-center">
                                <i class="fas fa-user-edit fa-2x me-3"></i>
                                <div>
                                    <h5 class="mb-0">Update Your Profile</h5>
                                    <small class="opacity-75">Keep your information current to get noticed by employers</small>
                                </div>
                            </div>
                        </div>
                        <div class="card-body p-4">
                            <form method="post" enctype="multipart/form-data">
                                {% csrf_token %}
                                
                                <!-- Personal Information Section -->
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h6 class="text-primary mb-3">
                                            <i class="fas fa-user me-2"></i>Personal Information
                                        </h6>
                                        <hr class="mb-4">
                                    </div>
                                    
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.phone.id_for_label }}" class="form-label">Phone Number</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                            {{ form.phone }}
                                        </div>
                                        {% if form.phone.errors %}
                                            <div class="text-danger small mt-1">{{ form.phone.errors }}</div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.location.id_for_label }}" class="form-label">Location</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-map-marker-alt"></i></span>
                                            {{ form.location }}
                                        </div>
                                        {% if form.location.errors %}
                                            <div class="text-danger small mt-1">{{ form.location.errors }}</div>
                                        {% endif %}
                                    </div>
                                </div>

                                <!-- Professional Information Section -->
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h6 class="text-success mb-3">
                                            <i class="fas fa-briefcase me-2"></i>Professional Information
                                        </h6>
                                        <hr class="mb-4">
                                    </div>
                                    
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.job_title.id_for_label }}" class="form-label">Current/Desired Job Title</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-briefcase"></i></span>
                                            {{ form.job_title }}
                                        </div>
                                        {% if form.job_title.errors %}
                                            <div class="text-danger small mt-1">{{ form.job_title.errors }}</div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.experience_level.id_for_label }}" class="form-label">Experience Level</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-chart-line"></i></span>
                                            {{ form.experience_level }}
                                        </div>
                                        {% if form.experience_level.errors %}
                                            <div class="text-danger small mt-1">{{ form.experience_level.errors }}</div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="col-12 mb-3">
                                        <label for="{{ form.bio.id_for_label }}" class="form-label">Professional Summary</label>
                                        {{ form.bio }}
                                        <div class="form-text">Write a brief summary about your professional background and career goals.</div>
                                        {% if form.bio.errors %}
                                            <div class="text-danger small mt-1">{{ form.bio.errors }}</div>
                                        {% endif %}
                                    </div>
                                    
                                    <div class="col-12 mb-3">
                                        <label for="{{ form.skills.id_for_label }}" class="form-label">Skills</label>
                                        {{ form.skills }}
                                        <div class="form-text">List your key skills separated by commas (e.g., Python, JavaScript, Project Management).</div>
                                        {% if form.skills.errors %}
                                            <div class="text-danger small mt-1">{{ form.skills.errors }}</div>
                                        {% endif %}
                                    </div>
                                    
                                    {% if form.experience_details %}
                                    <div class="col-12 mb-3">
                                        <label for="{{ form.experience_details.id_for_label }}" class="form-label">Experience Details</label>
                                        {{ form.experience_details }}
                                        <div class="form-text">Describe your work experience, achievements, and responsibilities.</div>
                                        {% if form.experience_details.errors %}
                                            <div class="text-danger small mt-1">{{ form.experience_details.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                </div>

                                <!-- Job Preferences Section -->
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h6 class="text-info mb-3">
                                            <i class="fas fa-cog me-2"></i>Job Preferences
                                        </h6>
                                        <hr class="mb-4">
                                    </div>
                                    
                                    {% if form.salary_expectation %}
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.salary_expectation.id_for_label }}" class="form-label">Salary Expectation (Annual)</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-dollar-sign"></i></span>
                                            {{ form.salary_expectation }}
                                        </div>
                                        {% if form.salary_expectation.errors %}
                                            <div class="text-danger small mt-1">{{ form.salary_expectation.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    {% if form.employment_type %}
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.employment_type.id_for_label }}" class="form-label">Preferred Employment Type</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-clock"></i></span>
                                            {{ form.employment_type }}
                                        </div>
                                        {% if form.employment_type.errors %}
                                            <div class="text-danger small mt-1">{{ form.employment_type.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    {% if form.availability %}
                                    <div class="col-md-6 mb-3">
                                        <label for="{{ form.availability.id_for_label }}" class="form-label">Availability</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-calendar"></i></span>
                                            {{ form.availability }}
                                        </div>
                                        <div class="form-text">When can you start? (e.g., Immediately, 2 weeks notice, etc.)</div>
                                        {% if form.availability.errors %}
                                            <div class="text-danger small mt-1">{{ form.availability.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    {% if form.remote_work %}
                                    <div class="col-md-6 mb-3">
                                        <div class="form-check form-switch mt-4">
                                            {{ form.remote_work }}
                                            <label class="form-check-label" for="{{ form.remote_work.id_for_label }}">
                                                <i class="fas fa-home me-2"></i>Open to remote work
                                            </label>
                                        </div>
                                        {% if form.remote_work.errors %}
                                            <div class="text-danger small mt-1">{{ form.remote_work.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                </div>

                                <!-- Social Links Section -->
                                {% if form.linkedin_url or form.portfolio_url or form.github_url %}
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h6 class="text-warning mb-3">
                                            <i class="fas fa-link me-2"></i>Social Links & Portfolio
                                        </h6>
                                        <hr class="mb-4">
                                    </div>
                                    
                                    {% if form.linkedin_url %}
                                    <div class="col-md-4 mb-3">
                                        <label for="{{ form.linkedin_url.id_for_label }}" class="form-label">LinkedIn Profile</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fab fa-linkedin"></i></span>
                                            {{ form.linkedin_url }}
                                        </div>
                                        {% if form.linkedin_url.errors %}
                                            <div class="text-danger small mt-1">{{ form.linkedin_url.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    {% if form.portfolio_url %}
                                    <div class="col-md-4 mb-3">
                                        <label for="{{ form.portfolio_url.id_for_label }}" class="form-label">Portfolio Website</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fas fa-globe"></i></span>
                                            {{ form.portfolio_url }}
                                        </div>
                                        {% if form.portfolio_url.errors %}
                                            <div class="text-danger small mt-1">{{ form.portfolio_url.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    {% if form.github_url %}
                                    <div class="col-md-4 mb-3">
                                        <label for="{{ form.github_url.id_for_label }}" class="form-label">GitHub Profile</label>
                                        <div class="input-group">
                                            <span class="input-group-text"><i class="fab fa-github"></i></span>
                                            {{ form.github_url }}
                                        </div>
                                        {% if form.github_url.errors %}
                                            <div class="text-danger small mt-1">{{ form.github_url.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                </div>
                                {% endif %}

                                <!-- Settings Section -->
                                {% if form.profile_visibility or form.email_notifications %}
                                <div class="row mb-4">
                                    <div class="col-12">
                                        <h6 class="text-secondary mb-3">
                                            <i class="fas fa-cog me-2"></i>Privacy & Notification Settings
                                        </h6>
                                        <hr class="mb-4">
                                    </div>
                                    
                                    {% if form.profile_visibility %}
                                    <div class="col-md-6 mb-3">
                                        <div class="form-check form-switch">
                                            {{ form.profile_visibility }}
                                            <label class="form-check-label" for="{{ form.profile_visibility.id_for_label }}">
                                                <i class="fas fa-eye me-2"></i>Make profile visible to employers
                                            </label>
                                            <div class="form-text">When enabled, employers can find and contact you directly.</div>
                                        </div>
                                        {% if form.profile_visibility.errors %}
                                            <div class="text-danger small mt-1">{{ form.profile_visibility.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                    
                                    {% if form.email_notifications %}
                                    <div class="col-md-6 mb-3">
                                        <div class="form-check form-switch">
                                            {{ form.email_notifications }}
                                            <label class="form-check-label" for="{{ form.email_notifications.id_for_label }}">
                                                <i class="fas fa-envelope me-2"></i>Receive email notifications
                                            </label>
                                            <div class="form-text">Get notified about job matches and messages.</div>
                                        </div>
                                        {% if form.email_notifications.errors %}
                                            <div class="text-danger small mt-1">{{ form.email_notifications.errors }}</div>
                                        {% endif %}
                                    </div>
                                    {% endif %}
                                </div>
                                {% endif %}

                                <!-- Use Crispy Forms for any remaining fields -->
                                <div class="row mb-4">
                                    <div class="col-12">
                                        {% for field in form %}
                                            {% if field.name not in "phone,location,job_title,experience_level,bio,skills,experience_details,salary_expectation,employment_type,availability,remote_work,linkedin_url,portfolio_url,github_url,profile_visibility,email_notifications" %}
                                                <div class="mb-3">
                                                    {{ field|as_crispy_field }}
                                                </div>
                                            {% endif %}
                                        {% endfor %}
                                    </div>
                                </div>

                                <!-- Action Buttons -->
                                <div class="row">
                                    <div class="col-12">
                                        <hr class="my-4">
                                        <div class="d-flex justify-content-between">
                                            <a href="{% url 'accounts:job_seeker_dashboard' %}" class="btn btn-outline-secondary">
                                                <i class="fas fa-times me-2"></i>Cancel
                                            </a>
                                            <div>
                                                <button type="submit" class="btn btn-primary">
                                                    <i class="fas fa-save me-2"></i>Save Profile
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Completion Tips -->
            <div class="row mt-4" data-aos="fade-up" data-aos-delay="200">
                <div class="col-12">
                    <div class="card border-info">
                        <div class="card-header bg-light">
                            <h6 class="mb-0 text-info">
                                <i class="fas fa-lightbulb me-2"></i>Profile Completion Tips
                            </h6>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Add a professional photo</li>
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Write a compelling summary</li>
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>List your key skills</li>
                                    </ul>
                                </div>
                                <div class="col-md-6">
                                    <ul class="list-unstyled">
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Include work experience</li>
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Add social media links</li>
                                        <li class="mb-2"><i class="fas fa-check text-success me-2"></i>Set realistic salary expectations</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
// Form validation and enhancement
document.addEventListener('DOMContentLoaded', function() {
    // Add Bootstrap classes to form elements
    const formControls = document.querySelectorAll('input[type="text"], input[type="email"], input[type="url"], input[type="number"], textarea, select');
    formControls.forEach(element => {
        if (element.type === 'checkbox') {
            element.classList.add('form-check-input');
        } else if (element.tagName === 'SELECT') {
            element.classList.add('form-select');
        } else {
            element.classList.add('form-control');
        }
    });
    
    // Auto-resize textareas
    const textareas = document.querySelectorAll('textarea');
    textareas.forEach(textarea => {
        textarea.addEventListener('input', function() {
            this.style.height = 'auto';
            this.style.height = this.scrollHeight + 'px';
        });
    });
    
    // Skills input enhancement
    const skillsInput = document.querySelector('textarea[name="skills"], input[name="skills"]');
    if (skillsInput) {
        skillsInput.addEventListener('blur', function() {
            // Clean up skills format
            let skills = this.value.split(',').map(skill => skill.trim()).filter(skill => skill);
            this.value = skills.join(', ');
        });
    }
});
</script>
{% endblock %}

{% block extra_css %}
<style>
    .form-control:focus, .form-select:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.25rem rgba(102, 126, 234, 0.15);
    }
    
    .input-group-text {
        background: rgba(102, 126, 234, 0.1);
        border-color: #e9ecef;
        color: var(--primary-color);
    }
    
    .form-check-input:checked {
        background-color: var(--primary-color);
        border-color: var(--primary-color);
    }
    
    textarea {
        min-height: 100px;
        resize: vertical;
    }
    
    .card-header {
        position: relative;
        overflow: hidden;
    }
    
    .card-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(45deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
    }
</style>
{% endblock %}
